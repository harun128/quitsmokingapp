{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _Box = _interopRequireDefault(require(\"../../components/UI/Box\"));\n\nvar _Text = _interopRequireDefault(require(\"../../components/UI/Text\"));\n\nvar _reactNative = require(\"react-native\");\n\nvar _colors = require(\"../../config/colors\");\n\nvar _icons = require(\"../../assets/icons\");\n\nvar _reactRedux = require(\"react-redux\");\n\nvar _UserSession = require(\"../../state/actions/UserSession\");\n\nvar _reactNativeImagePicker = _interopRequireDefault(require(\"react-native-image-picker\"));\n\nvar _global = require(\"../../config/global\");\n\nvar _18n = _interopRequireDefault(require(\"./../../lang/_18n\"));\n\nvar _reactNativeFastImage = _interopRequireDefault(require(\"react-native-fast-image\"));\n\nvar _jsxFileName = \"C:\\\\Projeler\\\\quitsmoking\\\\src\\\\screens\\\\Community\\\\MyProfile.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nvar MyProfile = function (_React$Component) {\n  (0, _inherits2.default)(MyProfile, _React$Component);\n\n  var _super = _createSuper(MyProfile);\n\n  function MyProfile(props) {\n    var _this;\n\n    (0, _classCallCheck2.default)(this, MyProfile);\n    _this = _super.call(this, props);\n\n    _this.handleProgress = function () {};\n\n    _this.upload = function (photo) {\n      var form = new FormData();\n      var token = _this.props.token;\n      form.append('photo', {\n        uri: Platform.OS === \"android\" ? photo.uri : photo.uri.replace(\"file://\", \"\"),\n        type: photo.type,\n        name: photo.fileName\n      });\n      fetch(_global.global.changeProfileImage, {\n        method: 'POST',\n        headers: {\n          'auth-token': token,\n          'Content-Type': 'multipart/form-data'\n        },\n        body: form\n      }).then(function (response) {\n        return response.json();\n      }).then(function (response) {\n        if (response.success === true) {\n          var _response$user;\n\n          (0, _UserSession.setImage)(response.user.image);\n          var url = \"https://quitsmokingapp.s3.eu-central-1.amazonaws.com/thumbnail/\" + ((_response$user = response.user) == null ? void 0 : _response$user.image) + \"?randomNumber=\" + new Date().getTime();\n          console.log(url);\n\n          _this.setState({\n            avatarSource: {\n              uri: url\n            }\n          });\n        }\n      }).catch(function (error) {\n        console.log(\"upload error\", error);\n        alert(\"Upload failed!\");\n      });\n    };\n\n    _this.selectImage = function () {\n      var options = {\n        title: 'Select Avatar',\n        storageOptions: {\n          skipBackup: true,\n          path: 'images'\n        }\n      };\n\n      _reactNativeImagePicker.default.showImagePicker(options, function (response) {\n        console.log('Response = ', response);\n\n        if (response.didCancel) {\n          console.log('User cancelled image picker');\n        } else if (response.error) {\n          console.log('ImagePicker Error: ', response.error);\n        } else if (response.customButton) {\n          console.log('User tapped custom button: ', response.customButton);\n        } else {\n          var source = {\n            uri: response.uri\n          };\n\n          _this.setState({\n            avatarSource: source,\n            photo: response\n          });\n\n          _this.upload(response);\n        }\n      });\n    };\n\n    var image = _this.props.image;\n    _this.state = {\n      avatarSource: {\n        uri: \"https://quitsmokingapp.s3.eu-central-1.amazonaws.com/thumbnail/\" + image,\n        method: \"GET\",\n        cache: 'only-if-cached'\n      },\n      photo: null,\n      uploadProgress: 0,\n      response: ''\n    };\n    return _this;\n  }\n\n  (0, _createClass2.default)(MyProfile, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var image = this.props.image;\n      var url = \"https://quitsmokingapp.s3.eu-central-1.amazonaws.com/thumbnail/\" + image + \"?random_number=\" + new Date().getTime();\n      this.setState({\n        avatarSource: {\n          uri: url\n        }\n      });\n      console.warn(image);\n      (0, _UserSession.verifyAccount)(this.props.token, function (result) {\n        if (result.success == true) {} else {}\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return _react.default.createElement(_reactNative.SafeAreaView, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 13\n        }\n      }, _react.default.createElement(_reactNative.ScrollView, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 17\n        }\n      }, _react.default.createElement(_Box.default, {\n        alignItems: \"center\",\n        flexDirection: \"column\",\n        mt: 10,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 17\n        }\n      }, _react.default.createElement(_reactNative.TouchableOpacity, {\n        activeOpacity: 0.6,\n        onPress: function onPress() {\n          return _this2.selectImage();\n        },\n        style: {},\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 21\n        }\n      }, _react.default.createElement(_reactNativeFastImage.default, {\n        style: {\n          width: 100,\n          height: 100,\n          borderRadius: 999\n        },\n        source: {\n          uri: \"https://quitsmokingapp.s3.eu-central-1.amazonaws.com/thumbnail/\" + this.props.image + \"?randomnumber=\" + new Date().getTime(),\n          priority: _reactNativeFastImage.default.priority.high,\n          cache: _reactNativeFastImage.default.cacheControl.web\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 25\n        }\n      }), _react.default.createElement(_icons.PlusIcon, {\n        style: {\n          position: 'absolute',\n          right: 0,\n          marginTop: 6,\n          marginRight: 6,\n          backgroundColor: 'white',\n          borderRadius: 999\n        },\n        color: \"#3498db\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 25\n        }\n      })), _react.default.createElement(_Text.default, {\n        fontWeight: \"bold\",\n        mt: 2,\n        color: _colors.colors.textDark,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 21\n        }\n      }, \"@\", this.props.username), _react.default.createElement(_Text.default, {\n        fontWeight: \"bold\",\n        mt: 2,\n        color: _colors.colors.textLight,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 21\n        }\n      }, this.props.location), _react.default.createElement(_Text.default, {\n        mx: 4,\n        fontWeight: \"bold\",\n        mt: 2,\n        color: _colors.colors.textLight,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 21\n        }\n      }, this.props.description), _react.default.createElement(_reactNative.TouchableOpacity, {\n        onPress: function onPress() {\n          return _this2.props.navigation.navigate(\"EditProfile\");\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 21\n        }\n      }, _react.default.createElement(_Box.default, {\n        bg: \"#FAB045\",\n        borderRadius: 8,\n        py: 3,\n        px: 5,\n        mt: 4,\n        flexDirection: \"row\",\n        justifyContent: \"center\",\n        alignItems: \"center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 25\n        }\n      }, _react.default.createElement(_icons.EditIcon, {\n        color: \"#fff\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 29\n        }\n      }), _react.default.createElement(_Text.default, {\n        ml: 3,\n        color: \"#fff\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 29\n        }\n      }, _18n.default.t(\"community.edit\")))))));\n    }\n  }]);\n  return MyProfile;\n}(_react.default.Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  var us = state.us;\n  return {\n    token: us.token,\n    image: us.image,\n    username: us.username,\n    location: us.location,\n    description: us.profileDescription\n  };\n};\n\nvar _default = (0, _reactRedux.connect)(mapStateToProps)(MyProfile);\n\nexports.default = _default;","map":{"version":3,"sources":["C:/Projeler/quitsmoking/src/screens/Community/MyProfile.js"],"names":["MyProfile","props","handleProgress","upload","photo","form","FormData","token","append","uri","Platform","OS","replace","type","name","fileName","fetch","global","changeProfileImage","method","headers","body","then","response","json","success","user","image","url","Date","getTime","console","log","setState","avatarSource","catch","error","alert","selectImage","options","title","storageOptions","skipBackup","path","ImagePicker","showImagePicker","didCancel","customButton","source","state","cache","uploadProgress","warn","result","width","height","borderRadius","priority","FastImage","high","cacheControl","web","position","right","marginTop","marginRight","backgroundColor","colors","textDark","username","textLight","location","description","navigation","navigate","I18n","t","React","Component","mapStateToProps","us","profileDescription"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport Box from \"../../components/UI/Box\";\r\nimport Text from \"../../components/UI/Text\";\r\nimport {SafeAreaView,TouchableOpacity,ScrollView} from \"react-native\";\r\nimport {colors} from \"../../config/colors\";\r\nimport {EditIcon,PlusIcon} from \"../../assets/icons\";\r\nimport {connect} from \"react-redux\";\r\nimport {verifyAccount} from \"../../state/actions/UserSession\";\r\n\r\nimport ImagePicker from \"react-native-image-picker\";\r\nimport {global} from \"../../config/global\";\r\nimport {setImage} from \"../../state/actions/UserSession\";\r\nimport I18n from \"./../../lang/_18n\"\r\nimport FastImage from 'react-native-fast-image'\r\n\r\nclass MyProfile extends React.Component{\r\n    constructor(props) {\r\n        super(props);\r\n        let {image} = this.props;\r\n\r\n        this.state = {\r\n            avatarSource  : {uri : \"https://quitsmokingapp.s3.eu-central-1.amazonaws.com/thumbnail/\"+image, method:\"GET\",cache: 'only-if-cached'},\r\n            photo : null,\r\n            uploadProgress:0,\r\n            response: ''\r\n        }\r\n    }\r\n\r\n    componentDidMount(): void {\r\n        let {image} = this.props;\r\n        let url = \"https://quitsmokingapp.s3.eu-central-1.amazonaws.com/thumbnail/\"+image+\"?random_number=\"+new Date().getTime();\r\n\r\n        this.setState({\r\n            avatarSource : {uri : url}\r\n        });\r\n        console.warn(image);\r\n\r\n\r\n\r\n\r\n        verifyAccount(this.props.token,function(result) {\r\n            if(result.success == true) {\r\n\r\n            }else {\r\n\r\n            }\r\n        });\r\n    }\r\n    handleProgress = () => {\r\n\r\n    }\r\n\r\n    upload =(photo) => {\r\n        const form = new FormData();\r\n        let token = this.props.token;\r\n        form.append('photo', {\r\n            uri: Platform.OS === \"android\" ? photo.uri : photo.uri.replace(\"file://\", \"\"),\r\n            type: photo.type,\r\n            name: photo.fileName,\r\n        });\r\n\r\n        fetch(global.changeProfileImage, {\r\n            method: 'POST',\r\n            headers: {\r\n                'auth-token': token,\r\n                'Content-Type': 'multipart/form-data',\r\n            },\r\n            body: form\r\n        })  .then(response => response.json())\r\n            .then(response => {\r\n                //console.log(\"upload succes\", response);\r\n                //alert(\"Upload success!\");\r\n                if(response.success === true) {\r\n\r\n                  // console.warn(response.user);\r\n                    setImage(response.user.image);\r\n                    let url = \"https://quitsmokingapp.s3.eu-central-1.amazonaws.com/thumbnail/\"+response.user?.image+\"?randomNumber=\"+new Date().getTime();\r\n                    console.log(url);\r\n                    this.setState({\r\n                        avatarSource : {uri : url}\r\n                    });\r\n                }\r\n            })\r\n            .catch(error => {\r\n                console.log(\"upload error\", error);\r\n                alert(\"Upload failed!\");\r\n            });\r\n    }\r\n\r\n    selectImage = () => {\r\n        const options = {\r\n            title: 'Select Avatar',\r\n            //customButtons: [{ name: 'fb', title: 'Choose Photo from Facebook' }],\r\n            storageOptions: {\r\n                skipBackup: true,\r\n                path: 'images',\r\n            },\r\n        };\r\n        ImagePicker.showImagePicker(options, (response) => {\r\n            console.log('Response = ', response);\r\n\r\n            if (response.didCancel) {\r\n                console.log('User cancelled image picker');\r\n            } else if (response.error) {\r\n                console.log('ImagePicker Error: ', response.error);\r\n            } else if (response.customButton) {\r\n                console.log('User tapped custom button: ', response.customButton);\r\n            } else {\r\n                const source = { uri: response.uri };\r\n                // You can also display the image using data:\r\n                // const source = { uri: 'data:image/jpeg;base64,' + response.data };\r\n                this.setState({\r\n                    avatarSource: source,\r\n                    photo : response,\r\n                });\r\n                // changeProfileImage(response,this.props.token,function(res){\r\n                //         console.warn(res);\r\n                // });\r\n\r\n                this.upload(response);\r\n            }\r\n        });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <SafeAreaView>\r\n                <ScrollView>\r\n                <Box alignItems={\"center\"} flexDirection={\"column\"} mt={10}>\r\n                    <TouchableOpacity activeOpacity={0.6}     onPress={() => this.selectImage()} style={{}} >\r\n                        <FastImage\r\n                            style={{width:100,height:100,borderRadius:999}}\r\n                            source={{\r\n                                uri: \"https://quitsmokingapp.s3.eu-central-1.amazonaws.com/thumbnail/\"+this.props.image+\"?randomnumber=\"+new Date().getTime(),\r\n\r\n                                priority: FastImage.priority.high,\r\n                                cache: FastImage.cacheControl.web,\r\n                                //cache: FastImage.cacheControl.web,\r\n                                //cache: FastImage.cacheControl.cacheOnly,\r\n                            }}\r\n                        />\r\n\r\n\r\n\r\n                        {/*<Image*/}\r\n                        {/*    style={{width:100,height:100,borderRadius:999}}*/}\r\n                        {/*    source={this.state.avatarSource}*/}\r\n                        {/*/>*/}\r\n                        <PlusIcon style={{position:'absolute',right:0, marginTop:6,marginRight:6, backgroundColor:'white', borderRadius:999}} color={\"#3498db\"} />\r\n                    </TouchableOpacity>\r\n\r\n                    <Text fontWeight={\"bold\"} mt={2} color={colors.textDark}>@{this.props.username}</Text>\r\n                    <Text fontWeight={\"bold\"} mt={2} color={colors.textLight}>{this.props.location}</Text>\r\n                    <Text mx={4} fontWeight={\"bold\"} mt={2} color={colors.textLight}>\r\n                        {this.props.description}\r\n                    </Text>\r\n                    <TouchableOpacity onPress={() => this.props.navigation.navigate(\"EditProfile\")}>\r\n                        <Box bg={\"#FAB045\"} borderRadius={8} py={3} px={5} mt={4} flexDirection={\"row\"} justifyContent={\"center\"} alignItems={\"center\"}>\r\n                            <EditIcon color={\"#fff\"} />\r\n                            <Text ml={3} color={\"#fff\"}>\r\n                                {I18n.t(\"community.edit\")}\r\n                            </Text>\r\n                        </Box>\r\n                    </TouchableOpacity>\r\n                </Box>\r\n                </ScrollView>\r\n            </SafeAreaView>\r\n        )\r\n    }\r\n}\r\nconst mapStateToProps =(state) => {\r\n    const {us} = state;\r\n    return {\r\n        token: us.token,\r\n        image:us.image,\r\n        username:us.username,\r\n        location:us.location,\r\n        description:us.profileDescription\r\n\r\n\r\n    }\r\n}\r\n\r\nexport default  connect(mapStateToProps)(MyProfile);\r\n"]},"metadata":{},"sourceType":"script"}